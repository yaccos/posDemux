<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combinatorial demultiplexer — combinatorial_demultiplex • posDemux</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combinatorial demultiplexer — combinatorial_demultiplex"><meta name="description" content="This function performs segmenting of sequences and combinatorial
demultiplexing and segmenting of sequences.
The sequences have a structure as defined by the argument
segments with corresponding lengths in segment_lengths.
As segmentation and extraction can take place from either end, a single
middle segment can be variadic in length. There are three types of segments:
Adapter, Barcode and Payload. The adapter is trimmed and ignored, the barcode
is used for demultiplexing,
and the payload is kept after segmenting and demultiplexing
and returned from the function.
If there are multiple payload segments, then
each segment constitutes its own segment in a list.
For type stability reasons,
such a list is returned also when there is zero or one payload segments.
The barcodes can be positioned at
either end of the sequences,
but no barcode can (for obvious reasons) be variadic in length."><meta property="og:description" content="This function performs segmenting of sequences and combinatorial
demultiplexing and segmenting of sequences.
The sequences have a structure as defined by the argument
segments with corresponding lengths in segment_lengths.
As segmentation and extraction can take place from either end, a single
middle segment can be variadic in length. There are three types of segments:
Adapter, Barcode and Payload. The adapter is trimmed and ignored, the barcode
is used for demultiplexing,
and the payload is kept after segmenting and demultiplexing
and returned from the function.
If there are multiple payload segments, then
each segment constitutes its own segment in a list.
For type stability reasons,
such a list is returned also when there is zero or one payload segments.
The barcodes can be positioned at
either end of the sequences,
but no barcode can (for obvious reasons) be variadic in length."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">posDemux</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/posDemux.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/streaming.html">Streaming data into the demultiplexer</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yaccos/posDemux/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Combinatorial demultiplexer</h1>
      <small class="dont-index">Source: <a href="https://github.com/yaccos/posDemux/blob/main/R/demultiplexer.R" class="external-link"><code>R/demultiplexer.R</code></a></small>
      <div class="d-none name"><code>combinatorial_demultiplex.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs segmenting of sequences and combinatorial
demultiplexing and segmenting of sequences.
The sequences have a structure as defined by the argument
<code>segments</code> with corresponding lengths in <code>segment_lengths</code>.
As segmentation and extraction can take place from either end, a single
middle segment can be variadic in length. There are three types of segments:
Adapter, Barcode and Payload. The adapter is trimmed and ignored, the barcode
is used for demultiplexing,
and the payload is kept after segmenting and demultiplexing
and returned from the function.
If there are multiple payload segments, then
each segment constitutes its own segment in a list.
For type stability reasons,
such a list is returned also when there is zero or one payload segments.
The barcodes can be positioned at
either end of the sequences,
but no barcode can (for obvious reasons) be variadic in length.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">combinatorial_demultiplex</span><span class="op">(</span><span class="va">sequences</span>, <span class="va">barcodes</span>, <span class="va">segments</span>, <span class="va">segment_lengths</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sequences">sequences<a class="anchor" aria-label="anchor" href="#arg-sequences"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">XStringSet</a></code>
object, the sequences to be demultiplexed.</p></dd>


<dt id="arg-barcodes">barcodes<a class="anchor" aria-label="anchor" href="#arg-barcodes"></a></dt>
<dd><p>A list of
<code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">XStringSet</a></code>
objects in the same order they appear in the <code>sequences</code>,
the barcodes to be used for demultiplexing.
All of the barcodes in each
<code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">XStringSet</a></code> must
have the same length as specified by the <code>segment_lengths</code> argument
and be named.
For computational reasons,
the maximum possible length of an individual barcode is 127.</p></dd>


<dt id="arg-segments">segments<a class="anchor" aria-label="anchor" href="#arg-segments"></a></dt>
<dd><p>Character vector showing the segments of the
sequences from 5' end to 3' end. The code applied is as follows:</p><ul><li><p><code>'A'</code>: Adapter (often referred to as linker),
is trimmed and ignored</p></li>
<li><p><code>'B'</code>: Barcode, used for demultiplexing</p></li>
<li><p><code>'P'</code>: Payload, sequence to be kept after trimming
and demultiplexing (e.g. cDNA or UMI).</p></li>
</ul><p>If this vector is named, this will determine the names of the payload sets.
Names of the barcode sets will be determined by the names of the argument
<code>barcodes</code> (if any).</p></dd>


<dt id="arg-segment-lengths">segment_lengths<a class="anchor" aria-label="anchor" href="#arg-segment-lengths"></a></dt>
<dd><p>Integer vector with the same length
as <code>segments</code>, lengths of the segments provided in the same order as in
<code>segments</code>.
Up to one of the non-barcode segments can have its length
set to <code>NA</code> which means
it is considered a variadic length segment.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements:</p><ul><li><p><code>assigned_barcodes</code>: A <code>character</code> matrix with
the names of the assigned barcodes as elements. The rows correspond to the
sequences and the columns to the barcode segments.</p></li>
<li><p><code>mismatches</code>: An <code>integer</code> matrix with
the number of mismatches
between the assigned barcodes and the sequences. The rows correspond to the
sequences and the columns to the barcode segments.</p></li>
<li><p><code>payload</code>: A list of
<code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">XStringSet</a></code> objects,
each containing the results for a payload segment.</p></li>
<li><p><code>barcodes</code>: The <code>barcodes</code> argument
passed into the function.
It is included in order to ease downstream processing.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If there are two barcodes both having the minimum number of mismatches
the first one will be selected. It is therefore important to choose the
error tolerance to be equal or less than the redundancy of the barcodes.
All sequences are assumed to be long enough for all segments to be extracted.
Otherwise, an error is raised.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings" class="external-link">Biostrings</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sequence_annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>UMI <span class="op">=</span> <span class="st">"P"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">segment_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7L</span>, <span class="fl">7L</span>, <span class="fl">15L</span>, <span class="fl">7L</span>, <span class="fl">14L</span>, <span class="fl">7L</span>, <span class="cn">NA_integer_</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">barcode_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"extdata/PETRI-seq_barcodes"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>bc1 <span class="op">=</span> <span class="st">"bc1.fa"</span>, bc2 <span class="op">=</span> <span class="st">"bc2.fa"</span>, bc3 <span class="op">=</span> <span class="st">"bc3.fa"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"posDemux"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">barcode_files</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"bc"</span>, <span class="fl">1L</span><span class="op">:</span><span class="fl">3L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">barcode_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">barcode_files</span>, <span class="va">readDNAStringSet</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">barcodes</span> <span class="op">&lt;-</span> <span class="va">barcode_index</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bc3"</span>, <span class="st">"bc2"</span>, <span class="st">"bc1"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">input_fastq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"extdata"</span>, <span class="st">"PETRI-seq_forward_reads.fq.gz"</span>, package <span class="op">=</span> <span class="st">"posDemux"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">reads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readDNAStringSet</a></span><span class="op">(</span><span class="va">input_fastq</span>, format <span class="op">=</span> <span class="st">"fastq"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">demultiplex_res</span> <span class="op">&lt;-</span> <span class="fu">combinatorial_demultiplex</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">reads</span>, barcodes <span class="op">=</span> <span class="va">barcodes</span>, segments <span class="op">=</span> <span class="va">sequence_annotation</span>,</span></span>
<span class="r-in"><span>    segment_lengths <span class="op">=</span> <span class="va">segment_lengths</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jakob Peder Pettersen, Centre for new antibacterial strategies (CANS).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

