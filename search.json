[{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU Affero General Public License","title":"GNU Affero General Public License","text":"Version 3, 19 November 2007 Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU Affero General Public License","text":"GNU Affero General Public License free, copyleft license software kinds works, specifically designed ensure cooperation community case network server software. licenses software practical works designed take away freedom share change works. contrast, General Public Licenses intended guarantee freedom share change versions program–make sure remains free software users. speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. Developers use General Public Licenses protect rights two steps: (1) assert copyright software, (2) offer License gives legal permission copy, distribute /modify software. secondary benefit defending users’ freedom improvements made alternate versions program, receive widespread use, become available developers incorporate. Many developers free software heartened encouraged resulting cooperation. However, case software used network servers, result may fail come . GNU General Public License permits making modified version letting public access server without ever releasing source code public. GNU Affero General Public License designed specifically ensure , cases, modified source code becomes available community. requires operator network server provide source code modified version running users server. Therefore, public use modified version, publicly accessible server, gives public access source code modified version. older license, called Affero General Public License published Affero, designed accomplish similar goals. different license, version Affero GPL, Affero released new version Affero GPL permits relicensing license. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions.","title":"GNU Affero General Public License","text":"“License” refers version 3 GNU Affero General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code.","title":"GNU Affero General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions.","title":"GNU Affero General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law.","title":"GNU Affero General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies.","title":"GNU Affero General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions.","title":"GNU Affero General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: work must carry prominent notices stating modified , giving relevant date. work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms.","title":"GNU Affero General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms.","title":"GNU Affero General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: Disclaiming warranty limiting liability differently terms sections 15 16 License; Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; Limiting use publicity purposes names licensors authors material; Declining grant rights trademark law use trade names, trademarks, service marks; Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination.","title":"GNU Affero General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies.","title":"GNU Affero General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients.","title":"GNU Affero General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents.","title":"GNU Affero General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom.","title":"GNU Affero General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_13-remote-network-interaction-use-with-the-gnu-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Remote Network Interaction; Use with the GNU General Public License.","title":"GNU Affero General Public License","text":"Notwithstanding provision License, modify Program, modified version must prominently offer users interacting remotely computer network (version supports interaction) opportunity receive Corresponding Source version providing access Corresponding Source network server charge, standard customary means facilitating copying software. Corresponding Source shall include Corresponding Source work covered version 3 GNU General Public License incorporated pursuant following paragraph. Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU General Public License single combined work, convey resulting work. terms License continue apply part covered work, work combined remain governed version 3 GNU General Public License.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License.","title":"GNU Affero General Public License","text":"Free Software Foundation may publish revised /new versions GNU Affero General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU Affero General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU Affero General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU Affero General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty.","title":"GNU Affero General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability.","title":"GNU Affero General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16.","title":"GNU Affero General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://yaccos.github.io/posDemux/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU Affero General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. software can interact users remotely computer network, also make sure provides way users get source. example, program web application, interface display “Source” link leads users archive code. many ways offer source, different solutions better different programs; see section 13 specific requirements. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU AGPL, see https://www.gnu.org/licenses/.","code":"<one line to give the program's name and a brief idea of what it does.>     Copyright (C) <year>  <name of author>      This program is free software: you can redistribute it and/or modify     it under the terms of the GNU Affero General Public License as     published by the Free Software Foundation, either version 3 of the     License, or (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU Affero General Public License for more details.      You should have received a copy of the GNU Affero General Public License     along with this program.  If not, see <https://www.gnu.org/licenses/>."},{"path":[]},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"when-and-why-to-use-this-package","dir":"Articles","previous_headings":"Basics","what":"When and why to use this package","title":"Introduction to combinatorial demultiplexing","text":"package aimed single-cell RNA-seq approaches SPLiT-seq [1; 2], BacDrop [3], PETRI-seq [4; 5]. , cell sequenced defined unique combination multiple DNA barcodes. assume individual barcodes come predefined whitelist, combination barcodes random every possible combination barcodes valid. order identify cell read coming , must extract barcodes, compare reference barcodes, find best match.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"required-knowledge","dir":"Articles","previous_headings":"Basics","what":"Required knowledge","title":"Introduction to combinatorial demultiplexing","text":"posDemux uses Biostrings package handling sequencing data hence basic understanding Biostrings necessary use package. Also important note fact posDemux provide utilities demultiplexing scRNA-seq data, designed part greater workflow. particular, package include essential components scRNA-seq workflow like quality control, alignment, feature counting UMI deduplication, neither provide utilities tertiary analysis gene count matrix constructed. Hence, user familiar components workflows [2] know functionality package plays part therein. asking question “start using Bioconductor?” might interested blog post.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"limitations","dir":"Articles","previous_headings":"Basics","what":"Limitations","title":"Introduction to combinatorial demultiplexing","text":"Since positional demultiplexer, position segments barcodes must known advance reads. Hence, package suited cases segments occur variable positions among reads. Furthermore, cases segments fixed positions among reads, segment lengths unknown, may require trial error obtain correct segmentation. demultiplexer written Illumina sequencing mind. assumes substitution sequencing errors may occur, safeguard indel sequencing errors. Hence, indel errors result erroneous segmentation failure assign correct barcode. sequencing platforms indel errors common, Nanopore sequencing, package may therefore suitable. package support combining barcodes reverse forward reads, limitation can circumvented either artificially merging reads manipulating result structures demultiplexer.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"ways-to-interact-with-this-package","dir":"Articles","previous_headings":"Basics","what":"Ways to interact with this package","title":"Introduction to combinatorial demultiplexing","text":"vignette describes basic usage package FASTQ files read R demultiplexing begins. large datasets memory-limited systems, reading sequences memory taxing. reason, posDemux streaming API parts input file read time. brevity, functionality explained vignette (vignette(\"streaming\")). believe end-users won’t interact package directly, rather form custom-made bioinformatic pipeline. Also, think developers bioinformatics pipelines prefer streaming API. Still, think developing package understanding low-level API understand hood.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"install-posdemux","dir":"Articles","previous_headings":"Basics","what":"Install posDemux","title":"Introduction to combinatorial demultiplexing","text":"package hosted Bioconductor repository R packages. order install fresh R install, run: want obtain development version package, available GitHub: compile package source, recommend use compiler flag -ftree-vectorize provides considerable speedup demultiplexer.","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(\"posDemux\")  ## Check that you have a valid Bioconductor installation BiocManager::valid() if (!requireNamespace(\"devtools\", quietly = TRUE)) {     install.packages(\"devtools\") }  devtools::install(\"yaccos/posDemux\")"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"asking-for-help","dir":"Articles","previous_headings":"Basics","what":"Asking for help","title":"Introduction to combinatorial demultiplexing","text":"package developers, try explain clearly use packages order use functions. R Bioconductor steep learning curve critical learn ask help. blog post quoted mentions like highlight Bioconductor support site main resource getting help: Remember use posDemux tag check older posts. alternatives available creating GitHub issues tweeting. However, please note want receive help adhere posting guidelines. particularly critical provide small reproducible example session information package developers can track source error.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"citing-posdemux","dir":"Articles","previous_headings":"Basics","what":"Citing posDemux","title":"Introduction to combinatorial demultiplexing","text":"hope posDemux useful research. Please use following information cite package overall approach. Thank !","code":"## Citation info citation(\"posDemux\") #> To cite package 'posDemux' in publications use: #>  #>   Pettersen J (2025). _posDemux: Positional combinatorial sequence #>   demultiplexer_. R package version 0.99.8, #>   <https://github.com/yaccos/posDemux>. #>  #> A BibTeX entry for LaTeX users is #>  #>   @Manual{, #>     title = {posDemux: Positional combinatorial sequence demultiplexer}, #>     author = {Jakob Peder Pettersen}, #>     year = {2025}, #>     note = {R package version 0.99.8}, #>     url = {https://github.com/yaccos/posDemux}, #>   }"},{"path":[]},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"quick-overview-of-the-method","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Quick overview of the method","title":"Introduction to combinatorial demultiplexing","text":"PETRI-seq method method single-cell RNA-sequencing bacteria [4; 5]. uses paired-end Illumina sequencing forward read contains cell barcodes transcript UMI, whereas reverse read contain cDNA aligned genome. Hence, posDemux applied forward reads. start loading posDemux helper packages:","code":"library(posDemux) library(Biostrings) library(purrr) library(magrittr)"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"sequence-annotation","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Sequence annotation","title":"Introduction to combinatorial demultiplexing","text":"PETRI-seq, forward read consists following segments following order (5’ 3’): UMI: 7 nucletides Barcode 3(bc3) : 7 nucleotides Linker: 15 nucletides Barcode 2(bc2): 7 nucleotides Linker: 14 nucletides Barcode 1(bc1): 7 nucleotides rest read ignored Hence, consider first segment, UMI, payload (denoted P sequence annotation) kept. three barcodes (denoted B) used demultiplexing. Finally, linkers read past Barcode 1 (denoted ) ignored. specify :","code":"sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_)"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"data-loading","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Data loading","title":"Introduction to combinatorial demultiplexing","text":"demultiplexing, need listing barcodes, course reads demultiplex. package, PETRI-seq barcodes synthetically generated reads provided. load barcodes: … FASTQ file containing forward reads: posDemux accepts DNAStringSet QualityScaledDNAStringSet input latter contain quality scores reads. However, quality score ignored demultiplexer reason pass QualityScaledDNAStringSet desirable retain quality scores payload.","code":"barcode_files <- system.file(\"extdata/PETRI-seq_barcodes\",     c(         bc1 = \"bc1.fa\",         bc2 = \"bc2.fa\",         bc3 = \"bc3.fa\"     ),     package = \"posDemux\" ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) input_fastq <- system.file(\"extdata\",     \"PETRI-seq_forward_reads.fq.gz\",     package = \"posDemux\" ) reads <- readDNAStringSet(input_fastq, format = \"fastq\")"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"running-the-demultiplexer","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Running the demultiplexer","title":"Introduction to combinatorial demultiplexing","text":"run demultiplexer, must ensure barcodes index arranged correct order: now ready run demultiplexer: main results demultiplexer table assigned barcodes: table mismatches barcode: well extracted UMI sequences:","code":"barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] demultiplex_res <- combinatorial_demultiplex(     reads,     barcodes = barcodes,     segments = sequence_annotation,     segment_lengths = segment_lengths ) head(demultiplex_res$assigned_barcodes) #>       bc3      bc2      bc1      #> seq_1 \"bc3_57\" \"bc2_51\" \"bc1_94\" #> seq_2 \"bc3_72\" \"bc2_94\" \"bc1_95\" #> seq_3 \"bc3_23\" \"bc2_37\" \"bc1_85\" #> seq_4 \"bc3_85\" \"bc2_81\" \"bc1_17\" #> seq_5 \"bc3_49\" \"bc2_64\" \"bc1_77\" #> seq_6 \"bc3_3\"  \"bc2_45\" \"bc1_33\" head(demultiplex_res$mismatches) #>       bc3 bc2 bc1 #> seq_1   0   0   0 #> seq_2   0   0   0 #> seq_3   2   2   2 #> seq_4   0   0   0 #> seq_5   0   0   0 #> seq_6   0   0   0 demultiplex_res$payload$UMI #> DNAStringSet object of length 56895: #>         width seq                                           names                #>     [1]     7 GCCTAAC                                       seq_1 #>     [2]     7 CCAAGCG                                       seq_2 #>     [3]     7 AGTGCAC                                       seq_3 #>     [4]     7 CCTAACG                                       seq_4 #>     [5]     7 GCTCGTC                                       seq_5 #>     ...   ... ... #> [56891]     7 ACGGCTT                                       seq_56891 #> [56892]     7 ATGAGCG                                       seq_56892 #> [56893]     7 ACCTGCG                                       seq_56893 #> [56894]     7 GGATATC                                       seq_56894 #> [56895]     7 GCCTTGA                                       seq_56895"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"error-correction","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Error correction","title":"Introduction to combinatorial demultiplexing","text":"posDemux handles two types reads filtering: Retaining reads matched barcode combination error correction. Removing barcode combinations reads usually artifacts assumed cover transcripts entire cell. subsection consider first type filtering. demultiplexing,barcode smallest Hamming distance read chosen number mismatches recorded. multiple barcodes equal distance query, one barcodes chosen. mismatches barcode sets, obviously want keep read. one barcode mismatches, posDemux allows error correction. case, keep read number mismatches barcodes certain threshold. example, smallest Hamming distance two different barcodes 33 barcode sets. Given nn, number barcode sequencing errors can reliably corrected barcode set, minimum distance required two distinct barcodes needs least 2n+12n+1. means case, can correct exactly one sequencing error: now inspect summary demultiplexing filtering: Now, results filtered_res$demultiplex_res shows reads either without mismatches error correction applied: can also see reads retained:","code":"filtered_res <- filter_demultiplex_res(     demultiplex_res,     allowed_mismatches = 1L ) filtered_res$summary_res #> Total number of reads: 56895  #> Number of reads failing to demultiplex: 4989 (8.77%)  #> Observed number of unique barcode combinations:978  #> Number of possible barcode combinations: 884736  #> Estimated number of features: 978.5  #> Observed feature to barcode ratio: 0.001105  #> Corrected feature to barcode ratio: 0.001106  #> Estimated number of observed barcode combinations #> corresponding to more than one feature: 0.5 (0.06%)  #> Number of barcode sets: 3  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc3  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51923 (91.26%)  #> Number of reads with 1 mismatches: 671 (1.18%)  #> Number of reads above mismatch threshold: 4301 (7.56%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc2  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51918 (91.25%)  #> Number of reads with 1 mismatches: 567 (1%)  #> Number of reads above mismatch threshold: 4410 (7.75%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc1  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51930 (91.27%)  #> Number of reads with 1 mismatches: 642 (1.13%)  #> Number of reads above mismatch threshold: 4323 (7.6%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - head(filtered_res$demultiplex_res$assigned_barcodes) #>       bc3      bc2      bc1      #> seq_1 \"bc3_57\" \"bc2_51\" \"bc1_94\" #> seq_2 \"bc3_72\" \"bc2_94\" \"bc1_95\" #> seq_4 \"bc3_85\" \"bc2_81\" \"bc1_17\" #> seq_5 \"bc3_49\" \"bc2_64\" \"bc1_77\" #> seq_6 \"bc3_3\"  \"bc2_45\" \"bc1_33\" #> seq_7 \"bc3_17\" \"bc2_57\" \"bc1_71\" head(filtered_res$demultiplex_res$mismatches) #>       bc3 bc2 bc1 #> seq_1   0   0   0 #> seq_2   0   0   0 #> seq_4   0   0   0 #> seq_5   0   0   0 #> seq_6   0   0   0 #> seq_7   0   0   0 head(filtered_res$retained) #> seq_1 seq_2 seq_3 seq_4 seq_5 seq_6  #>  TRUE  TRUE FALSE  TRUE  TRUE  TRUE"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"filtering-by-barcode-frequency","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Filtering by barcode frequency","title":"Introduction to combinatorial demultiplexing","text":"Now conducted filtering based barcode mismatches, proceed second kind filtering. utilizes Knee method [6; 4] barcode combinations arranged descending order frequency abundant ones selected. cutoff set achieve saturation reads covered, yet remaining barcode combinations covered small number reads. first create frequency table barcodes question: package contains interaction Shiny application selecting number barcodes. can run : working outside RStudio, may run opening resulting link inside browser. working headless system, may consider: Using RStudio Server Opening reverse ssh tunnel Shiny server Copy frequency table onto local machine run application run application, see keeping approximately 500 barcodes optimal choice1. can also calculate frequency least abundant barcode combination included. can convert cutoff way well, general exact inverse multiple barcodes can frequency: cutoff can illustrated Knee plot interactive application:  can also illustrate filtering looking distribution barcode frequencies:  Often frequency plot gets easier interpret scale y-axis number reads, hence creating mass plot reads distributed based respective barcodes:","code":"freq_table <- create_freq_table(     filtered_res$demultiplex_res$assigned_barcodes ) head(freq_table) #>      bc3    bc2    bc1 frequency cumulative_frequency    fraction #> 1 bc3_37  bc2_4 bc1_30       270                  270 0.005201711 #> 2 bc3_45 bc2_36 bc1_65       246                  516 0.004739336 #> 3 bc3_25 bc2_34 bc1_25       235                  751 0.004527415 #> 4 bc3_40 bc2_62 bc1_42       221                  972 0.004257697 #> 5 bc3_69 bc2_95 bc1_37       219                 1191 0.004219165 #> 6 bc3_29 bc2_90 bc1_40       217                 1408 0.004180634 #>   cumulative_fraction #> 1         0.005201711 #> 2         0.009941047 #> 3         0.014468462 #> 4         0.018726159 #> 5         0.022945324 #> 6         0.027125958 interactive_bc_cutoff(freq_table) app <- interactive_bc_cutoff(freq_table) shiny::runApp(app, launch.browser = FALSE) bc_cutoff <- 500L freq_cutoff <- bc_to_freq_cutoff(freq_table, bc_cutoff) freq_cutoff #> [1] 8 reconstrued_bc_cutoff <- freq_to_bc_cutoff(     freq_table,     freq_cutoff ) reconstrued_bc_cutoff #> [1] 505 knee_plot(freq_table = freq_table, cutoff = bc_cutoff) # Since the cutoff lines of the plot are provided by the literal x-coordinate, # we must use the frequency cutoff freq_plot(freq_table,     cutoff = freq_cutoff, type = \"density\",     log_scale_x = TRUE ) # Since the cutoff lines of the plot are provided by the literal x-coordinate, # we must use the frequency cutoff freq_plot(freq_table,     cutoff = freq_cutoff, type = \"density\",     log_scale_x = TRUE, scale_by_reads = TRUE )"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"exporting-results","dir":"Articles","previous_headings":"An example with PETRI-seq","what":"Exporting results","title":"Introduction to combinatorial demultiplexing","text":"Now know many barcodes keep, can extract desired results write table. start frequency table. Since already sorted descending order frequency, simply take top entries table: finding reads correspond barcodes, following: continue UMIs convert character vector (remember payload assigned barcodes aligned order): done, can make data frame containing UMI, read identifier, barcode assignments: Finally, can write table file. following suggested way achieving desired formatting:","code":"selected_freq_table <- freq_table[seq_len(bc_cutoff), ] assigned_barcodes <- filtered_res$demultiplex_res$assigned_barcodes read_in_selection <- row_match(assigned_barcodes, selected_freq_table) selected_assigned_barcodes <- assigned_barcodes[read_in_selection, ] assigned_UMI <- filtered_res$demultiplex_res$payload$UMI %>% as.character() selected_assigned_UMI <- assigned_UMI[read_in_selection] res_table <- as.data.frame(selected_assigned_barcodes) %>%     dplyr::mutate(         read = rownames(selected_assigned_barcodes),         UMI = selected_assigned_UMI     ) %>%     # Ensures the columns appears in the desired order     dplyr::select(read, UMI, bc3, bc2, bc1) head(res_table) #>        read     UMI    bc3    bc2    bc1 #> seq_1 seq_1 GCCTAAC bc3_57 bc2_51 bc1_94 #> seq_2 seq_2 CCAAGCG bc3_72 bc2_94 bc1_95 #> seq_4 seq_4 CCTAACG bc3_85 bc2_81 bc1_17 #> seq_5 seq_5 GCTCGTC bc3_49 bc2_64 bc1_77 #> seq_6 seq_6 TGGAGAA  bc3_3 bc2_45 bc1_33 #> seq_7 seq_7 ACTTCGA bc3_17 bc2_57 bc1_71 file <- tempfile(pattern = \"barcode_table\", fileext = \".txt\") write.table(res_table, file,     row.names = FALSE,     col.names = TRUE, sep = \"\\t\", eol = \"\\n\", quote = FALSE )"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"reproducibility","dir":"Articles","previous_headings":"","what":"Reproducibility","title":"Introduction to combinatorial demultiplexing","text":"posDemux package made possible thanks : R BiocStyle knitr RefManageR rmarkdown sessioninfo testthat package developed using biocthis. R session information:","code":"#> ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────── #>  setting  value #>  version  R Under development (unstable) (2025-12-14 r89168) #>  os       Ubuntu 24.04.3 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  C.UTF-8 #>  ctype    C.UTF-8 #>  tz       UTC #>  date     2025-12-16 #>  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown) #>  quarto   NA #>  #> ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────── #>  package      * version   date (UTC) lib source #>  assertthat     0.2.1     2019-03-21 [1] RSPM #>  backports      1.5.0     2024-05-23 [1] RSPM #>  bibtex         0.5.1     2023-01-26 [1] RSPM #>  BiocGenerics * 0.57.0    2025-10-30 [1] Bioconduc~ #>  BiocManager    1.30.27   2025-11-14 [1] RSPM #>  BiocStyle    * 2.39.0    2025-10-30 [1] Bioconduc~ #>  Biostrings   * 2.79.2    2025-11-05 [1] Bioconduc~ #>  bookdown       0.46      2025-12-05 [1] RSPM #>  bslib          0.9.0     2025-01-30 [1] RSPM #>  cachem         1.1.0     2024-05-16 [1] RSPM #>  cli            3.6.5     2025-04-23 [1] RSPM #>  crayon         1.5.3     2024-06-20 [1] RSPM #>  desc           1.4.3     2023-12-10 [1] RSPM #>  digest         0.6.39    2025-11-19 [1] RSPM #>  dplyr          1.1.4     2023-11-17 [1] RSPM #>  evaluate       1.0.5     2025-08-27 [1] RSPM #>  farver         2.1.2     2024-05-13 [1] RSPM #>  fastmap        1.2.0     2024-05-15 [1] RSPM #>  fs             1.6.6     2025-04-12 [1] RSPM #>  generics     * 0.1.4     2025-05-09 [1] RSPM #>  ggplot2        4.0.1     2025-11-14 [1] RSPM #>  glue           1.8.0     2024-09-30 [1] RSPM #>  gtable         0.3.6     2024-10-25 [1] RSPM #>  htmltools      0.5.9     2025-12-04 [1] RSPM #>  htmlwidgets    1.6.4     2023-12-06 [1] RSPM #>  httpuv         1.6.16    2025-04-16 [1] RSPM #>  httr           1.4.7     2023-08-15 [1] RSPM #>  IRanges      * 2.45.0    2025-10-31 [1] Bioconduc~ #>  jquerylib      0.1.4     2021-04-26 [1] RSPM #>  jsonlite       2.0.0     2025-03-27 [1] RSPM #>  knitr          1.50      2025-03-16 [1] RSPM #>  labeling       0.4.3     2023-08-29 [1] RSPM #>  later          1.4.4     2025-08-27 [1] RSPM #>  lifecycle      1.0.4     2023-11-07 [1] RSPM #>  lubridate      1.9.4     2024-12-08 [1] RSPM #>  magrittr     * 2.0.4     2025-09-12 [1] RSPM #>  mime           0.13      2025-03-17 [1] RSPM #>  otel           0.2.0     2025-08-29 [1] RSPM #>  pillar         1.11.1    2025-09-17 [1] RSPM #>  pkgconfig      2.0.3     2019-09-22 [1] RSPM #>  pkgdown        2.2.0     2025-11-06 [1] RSPM #>  plyr           1.8.9     2023-10-02 [1] RSPM #>  posDemux     * 0.99.8    2025-12-16 [1] local #>  promises       1.5.0     2025-11-01 [1] RSPM #>  purrr        * 1.2.0     2025-11-04 [1] RSPM #>  R6             2.6.1     2025-02-15 [1] RSPM #>  ragg           1.5.0     2025-09-02 [1] RSPM #>  RColorBrewer   1.1-3     2022-04-03 [1] RSPM #>  Rcpp           1.1.0.8.1 2025-12-08 [1] RSPM #>  RefManageR   * 1.4.0     2022-09-30 [1] RSPM #>  rlang          1.1.6     2025-04-11 [1] RSPM #>  rmarkdown      2.30      2025-09-28 [1] RSPM #>  S4Vectors    * 0.49.0    2025-10-30 [1] Bioconduc~ #>  S7             0.2.1     2025-11-14 [1] RSPM #>  sass           0.4.10    2025-04-11 [1] RSPM #>  scales         1.4.0     2025-04-24 [1] RSPM #>  Seqinfo      * 1.1.0     2025-10-31 [1] Bioconduc~ #>  sessioninfo  * 1.2.3     2025-02-05 [1] RSPM #>  shiny          1.12.1    2025-12-09 [1] RSPM #>  stringi        1.8.7     2025-03-27 [1] RSPM #>  stringr        1.6.0     2025-11-04 [1] RSPM #>  systemfonts    1.3.1     2025-10-01 [1] RSPM #>  textshaping    1.0.4     2025-10-10 [1] RSPM #>  tibble         3.3.0     2025-06-08 [1] RSPM #>  tidyselect     1.2.1     2024-03-11 [1] RSPM #>  timechange     0.3.0     2024-01-18 [1] RSPM #>  vctrs          0.6.5     2023-12-01 [1] RSPM #>  withr          3.0.2     2024-10-28 [1] RSPM #>  xfun           0.54      2025-10-30 [1] RSPM #>  xml2           1.5.1     2025-12-01 [1] RSPM #>  xtable         1.8-4     2019-04-21 [1] RSPM #>  XVector      * 0.51.0    2025-10-31 [1] Bioconduc~ #>  yaml           2.3.12    2025-12-10 [1] RSPM #>  #>  [1] /home/runner/work/_temp/Library #>  [2] /opt/R/devel/lib/R/site-library #>  [3] /opt/R/devel/lib/R/library #>  * ── Packages attached to the search path. #>  #> ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────"},{"path":"https://yaccos.github.io/posDemux/articles/demultiplexing.html","id":"bibliography","dir":"Articles","previous_headings":"","what":"Bibliography","title":"Introduction to combinatorial demultiplexing","text":"vignette generated using BiocStyle knitr rmarkdown running behind scenes. Citations made RefManageR . [1] . B. Rosenberg, C. M. Roco, R. . Muscat, et al. “Single-cell profiling developing mouse brain spinal cord split-pool barcoding”. : Science 360.6385 (Apr. 2018), pp. 176–182. DOI: 10.1126/science.aam8999. URL: https://www.science.org/doi/10.1126/science.aam8999 (visited 01/23/2025). [2] L. Kuijpers, B. Hornung, M. C. G. N. van den Hout - van Vroonhoven, et al. “Split Pool Ligation-based Single-cell Transcriptome sequencing (SPLiT-seq) data processing pipeline comparison”. : BMC Genomics 25.1 (Apr. 2024), p. 361. ISSN: 1471-2164. DOI: 10.1186/s12864-024-10285-3. URL: https://doi.org/10.1186/s12864-024-10285-3 (visited 01/08/2025). [3] P. Ma, H. M. Amemiya, L. L. , et al. “Bacterial droplet-based single-cell RNA-seq reveals antibiotic-associated heterogeneous cellular states”. : Cell 186.4 (Feb. 2023), pp. 877–891.e14. ISSN: 0092-8674. DOI: 10.1016/j.cell.2023.01.002. URL: https://www.sciencedirect.com/science/article/pii/S0092867423000028 (visited 01/31/2025). [4] S. B. Blattman, W. Jiang, P. Oikonomou, et al. “Prokaryotic single-cell RNA sequencing situ combinatorial indexing”. En. : Nature Microbiology 5.10 (Oct. 2020), pp. 1192–1201. ISSN: 2058-5276. DOI: 10.1038/s41564-020-0729-6. URL: https://www.nature.com/articles/s41564-020-0729-6 (visited 12/12/2024). [5] S. B. Blattman, W. Jiang, E. R. McGarrigle, et al. “Identification genetic dissection convergent persister cell states”. En. : Nature 636.8042 (Dec. 2024), pp. 438–446. ISSN: 1476-4687. DOI: 10.1038/s41586-024-08124-2. URL: https://www.nature.com/articles/s41586-024-08124-2 (visited 01/08/2025). [6] E. Macosko, . Basu, R. Satija, et al. “Highly Parallel Genome-wide Expression Profiling Individual Cells Using Nanoliter Droplets”. : Cell 161.5 (2015), pp. 1202-1214. ISSN: 0092-8674. DOI: https://doi.org/10.1016/j.cell.2015.05.002. URL: https://www.sciencedirect.com/science/article/pii/S0092867415005498.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"why-streaming","dir":"Articles","previous_headings":"","what":"Why streaming?","title":"Streaming data into the demultiplexer","text":"Given sequence files can consist gigabytes data, storing everything memory can prove much computer. Fortunately, demultiplexing barcodes, can demultiplex barcodes independently . theory, read entries FASTQ file one one, call demultiplexer output barcode assignment file. However, due overhead file operations R interpreter, efficient option process files chunks predetermined size. read main package vignette yet (vignette(\"demultiplexing\")), please proceeding.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"which-chunk-size-to-use","dir":"Articles","previous_headings":"Why streaming?","what":"Which chunk size to use?","title":"Streaming data into the demultiplexer","text":"chunk size large enough constant overhead initiating file read interpreting required R instructions neglectable. Still, chunk size small enough make modest memory footprint. practice, modern computers gigabytes RAM, find chunk size 2⋅1052\\cdot10^5 reads reasonable choice. example datasets used vignette far small require streaming (including dataset realistic size make package exceed maximum package size), purely demonstrational purposes, choose chunk size 10410^4 reads.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"overview-of-the-streaming-api","dir":"Articles","previous_headings":"Why streaming?","what":"Overview of the streaming API","title":"Streaming data into the demultiplexer","text":"streaming API posDemux focused around two user-supplied functions: loader: function responsible grabbing chunk input file sequences returning XStringSet object sequences. Also, function determines terminate streaming, typically done sequences left. archiver: function responsible writing results demultiplexer chunk file, typically form barcode table. loader archiver specified combined demultiplexer, can generate barcode table chunk chunk. However, still want generate summary statistics frequency table reads demultiplexed simultaneously. chunks demultiplexed independently, create_summary_res() create_freq_table() don’t work intended. core function streaming API; streaming_demultiplex() comes play. accepts loader archiver callback functions, communicates demultiplexer, bookkeeping construct summary statistics frequency table. Hence, chunk, loader provides sequences demultiplex, streaming logic feeds reads demultiplexer, updates record observed barcodes provides results archiver writes barcode table. process illustrated Figure @ref(fig:structure). communicating loader archiver, user-defined state object passed streaming_demultiplex(). initial value object provided streaming_demultiplex() argument state_init. Components streaming API","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"streaming-using-default-callbacks","dir":"Articles","previous_headings":"","what":"Streaming using default callbacks","title":"Streaming data into the demultiplexer","text":"Although option specifying loader archiver gives great flexibility, cost convenience loader archiver can challenging write. reason, posDemux provides default set streaming callbacks available streaming_callbacks(). Actually, function factory, returns list following elements: state_init: initial state provide streaming_demultiplex() loader: Loader function archiver: Archiver function","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"assumptions","dir":"Articles","previous_headings":"Streaming using default callbacks","what":"Assumptions","title":"Streaming data into the demultiplexer","text":"callbacks designed useful typical use case : reads contained single FASTQ file disk. barcode table contains columns read names (read), sequences payloads (eg.UMI) barcode assignments (eg. BC3, BC2, BC1). Read names spaces truncated loader part read name space kept. done information preceding space typically enough ambiguously identify read, information space usually contains irrelevant auxiliary information. Progress many reads processed can optionally displayed archiver chunk. fill needs, please refer section Streaming using custom callbacks.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"obtaining-the-callbacks","dir":"Articles","previous_headings":"Streaming using default callbacks","what":"Obtaining the callbacks","title":"Streaming data into the demultiplexer","text":"said, streaming_callbacks() function factory, must specify file path FASTQ input file, barcode table output file generate useful callbacks. addition, chunk size regulated callbacks. use dataset main package vignette (vignette(\"demultiplexing\")) obtain callbacks follows:","code":"library(posDemux) input_fastq <- system.file(\"extdata\",     \"PETRI-seq_forward_reads.fq.gz\",     package = \"posDemux\" ) output_barcode_table <- tempfile(     pattern = \"barcode_table\",     fileext = \".txt\" ) default_callbacks <- streaming_callbacks(     input_file = input_fastq,     output_table_file = output_barcode_table,     chunk_size = 1e+4,     verbose = TRUE )"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"running-the-demultiplexing","dir":"Articles","previous_headings":"Streaming using default callbacks","what":"Running the demultiplexing","title":"Streaming data into the demultiplexer","text":"callbacks place, specify barcodes, segments feed streaming framework:","code":"suppressPackageStartupMessages({     library(purrr)     library(Biostrings) }) barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),     package = \"posDemux\" ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) streaming_summary_res <- streaming_demultiplex(     state_init = default_callbacks$state_init,     loader = default_callbacks$loader,     archiver = default_callbacks$archiver,     barcodes = barcodes,     allowed_mismatches = 1L,     segments = sequence_annotation,     segment_lengths = segment_lengths ) #> Tue Dec 16 10:16:33 2025 => Initializing FASTQ stream and output table #> Tue Dec 16 10:16:33 2025 => Streaming FASTQ input file /home/runner/work/_temp/Library/posDemux/extdata/PETRI-seq_forward_reads.fq.gz #> Tue Dec 16 10:16:39 2025 => Processed 10000 reads, successfully demultiplexed 9117 reads so far... #> Tue Dec 16 10:16:39 2025 => Processed 20000 reads, successfully demultiplexed 18259 reads so far... #> Tue Dec 16 10:16:39 2025 => Processed 30000 reads, successfully demultiplexed 27362 reads so far... #> Tue Dec 16 10:16:39 2025 => Processed 40000 reads, successfully demultiplexed 36487 reads so far... #> Tue Dec 16 10:16:40 2025 => Processed 50000 reads, successfully demultiplexed 45629 reads so far... #> Tue Dec 16 10:16:40 2025 => Processed 56895 reads, successfully demultiplexed 51906 reads so far... #> Tue Dec 16 10:16:40 2025 => Done demultiplexing"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"displaying-the-result-from-streaming","dir":"Articles","previous_headings":"Streaming using default callbacks","what":"Displaying the result from streaming","title":"Streaming data into the demultiplexer","text":"return value streaming_demultiplex(), obtain frequency table summary printout:","code":"head(streaming_summary_res$freq_table) #>      bc3    bc2    bc1 frequency cumulative_frequency    fraction #> 1 bc3_37  bc2_4 bc1_30       270                  270 0.005201711 #> 2 bc3_45 bc2_36 bc1_65       246                  516 0.004739336 #> 3 bc3_25 bc2_34 bc1_25       235                  751 0.004527415 #> 4 bc3_40 bc2_62 bc1_42       221                  972 0.004257697 #> 5 bc3_69 bc2_95 bc1_37       219                 1191 0.004219165 #> 6 bc3_56 bc2_94 bc1_29       217                 1408 0.004180634 #>   cumulative_fraction #> 1         0.005201711 #> 2         0.009941047 #> 3         0.014468462 #> 4         0.018726159 #> 5         0.022945324 #> 6         0.027125958 streaming_summary_res$summary_res #> Total number of reads: 56895  #> Number of reads failing to demultiplex: 4989 (8.77%)  #> Observed number of unique barcode combinations:978  #> Number of possible barcode combinations: 884736  #> Estimated number of features: 978.5  #> Observed feature to barcode ratio: 0.001105  #> Corrected feature to barcode ratio: 0.001106  #> Estimated number of observed barcode combinations #> corresponding to more than one feature: 0.5 (0.06%)  #> Number of barcode sets: 3  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc3  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51923 (91.26%)  #> Number of reads with 1 mismatches: 671 (1.18%)  #> Number of reads above mismatch threshold: 4301 (7.56%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc2  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51918 (91.25%)  #> Number of reads with 1 mismatches: 567 (1%)  #> Number of reads above mismatch threshold: 4410 (7.75%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc1  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51930 (91.27%)  #> Number of reads with 1 mismatches: 642 (1.13%)  #> Number of reads above mismatch threshold: 4323 (7.6%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -"},{"path":[]},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"considerations-about-size-of-tables","dir":"Articles","previous_headings":"Streaming the barcode table","what":"Considerations about size of tables","title":"Streaming data into the demultiplexer","text":"frequency table realistic PETRI-seq dataset relatively small (just megabytes) therefore pose substantial memory usage problems. hand, barcode table one row read processed, making memory footprint closer size original FASTQ-file. end, default archiver writes barcode table disk chunk, thus avoiding keeping table memory. However, barcode table required downstream step pipeline. Typically, frequency filtering. good news cutoff determination process needs light frequency table. bad news full barcode table required determining reads keep cutoff selected. want avoid heavy load RAM, must stream barcode table chunks, determine chunk reads keep, appending results another file. ## Subsetting frequency table begin example subsetting frequency table. order repeat , refer main package vignette (vignette(\"demultiplexing\")) considerations behind process.","code":"freq_table <- streaming_summary_res$freq_table bc_cutoff <- 500L selected_freq_table <- freq_table[seq_len(bc_cutoff), ]"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"writing-to-database","dir":"Articles","previous_headings":"Streaming the barcode table","what":"Writing to database","title":"Streaming data into the demultiplexer","text":"typically want create copy barcode table including reads selected barcode frequency thus match row selected_freq_table. use direct approach provide selected barcode table file format, just desired rows kept. However, become impractical downstream analysis using new table lookup require us load memory, causing problem one level . memory-constrained environments, therefore suggest another idea: Dumping data SQLite database later can queried. simplicity, paste barcode designations together one column. begin setting database: streaming barcode table combining outputting database, use chunked package: Finally, make index barcodes lookups fast close database connection:","code":"suppressPackageStartupMessages({     library(DBI) }) output_database_path <- tempfile(     pattern = \"selected_barcode_table\",     fileext = \".sqlite\" ) output_db <- dbConnect(RSQLite::SQLite(), output_database_path) chunk_size <- 1e4 suppressPackageStartupMessages({     library(chunked)     library(magrittr) }) read_table_chunkwise(     file = output_barcode_table,     header = TRUE,     sep = \"\\t\",     chunk_size = chunk_size ) %>%     # For use within a pipeline, it is more convenient to use inner_join()      # than posDemux::row_match() and it achieves the save result     inner_join(selected_freq_table) %>%     mutate(         celltag = do.call(             paste,             c(barcodes %>% names() %>% all_of() %>% across(), sep = \"_\")         )     ) %>%     select(read, UMI, celltag) %>%     write_chunkwise(dbplyr::src_dbi(output_db), \"selected_barcodes\") #> Joining with `by = join_by(bc3, bc2, bc1)` #> Joining with `by = join_by(bc3, bc2, bc1)` #> Joining with `by = join_by(bc3, bc2, bc1)` #> Joining with `by = join_by(bc3, bc2, bc1)` #> Joining with `by = join_by(bc3, bc2, bc1)` #> Joining with `by = join_by(bc3, bc2, bc1)` #> # Source:   table<`selected_barcodes`> [?? x 3] #> # Database: sqlite 3.51.1 [/tmp/RtmpLJJI3n/selected_barcode_table335225de6d9a.sqlite] #>    read   UMI     celltag              #>    <chr>  <chr>   <chr>                #>  1 seq_1  GCCTAAC bc3_57_bc2_51_bc1_94 #>  2 seq_2  CCAAGCG bc3_72_bc2_94_bc1_95 #>  3 seq_4  CCTAACG bc3_85_bc2_81_bc1_17 #>  4 seq_5  GCTCGTC bc3_49_bc2_64_bc1_77 #>  5 seq_6  TGGAGAA bc3_3_bc2_45_bc1_33  #>  6 seq_7  ACTTCGA bc3_17_bc2_57_bc1_71 #>  7 seq_8  GCCCGCA bc3_69_bc2_65_bc1_49 #>  8 seq_9  CCCATGT bc3_38_bc2_87_bc1_83 #>  9 seq_10 TGCCGGT bc3_76_bc2_36_bc1_85 #> 10 seq_11 CAACTCA bc3_15_bc2_84_bc1_16 #> # ℹ more rows dbExecute(output_db, \"CREATE INDEX idx ON selected_barcodes(read)\") %>%     invisible() dbDisconnect(output_db)"},{"path":[]},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"desired-properties","dir":"Articles","previous_headings":"Streaming using custom callbacks","what":"Desired properties","title":"Streaming data into the demultiplexer","text":"cases default callbacks sufficient, possible user write custom callback functions. example, use sample dataset , pretend reads reason come FASTA file (default loader support). addition, want UMIs go FASTA files instead column barcode table. Unlike default callbacks, don’t truncate read names.","code":""},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"the-state-object","dir":"Articles","previous_headings":"Streaming using custom callbacks","what":"The state object","title":"Streaming data into the demultiplexer","text":"progress printouts, want state object streaming contain total number reads number reads demultiplexing successful. Additionally, specific case, loader needs know begin reading FASTA file chunk. final numbers, really necessary required information provided streaming framework finishing. Thus, want state object contain following fields integers: total_reads demultiplexed_reads total_reads updated loader, whereas demultiplexed_reads updated archiver end chunk. Furthermore, archiver needs write column headers barcode table first writing , must know whether working first chunk. gives rise logical flag output_table_initialized. thus initialize state follows:","code":"custom_state_init <- list(     total_reads = 0L, demultiplexed_reads = 0L,     output_table_initialized = FALSE )"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"the-loader","dir":"Articles","previous_headings":"Streaming using custom callbacks","what":"The loader","title":"Streaming data into the demultiplexer","text":"loader function accepts state sole parameter outputs list three fields: state: passed archiver. sequences: sequences chunk Biostrings::DNAStringSet object. should_terminate: logical flag signal streaming framework terminate. Note also means loader charge termination criterion. decide hard-code loader parse 10410^4 reads chunk.","code":"input_fasta <- system.file(\"extdata\", \"PETRI-seq_forward_reads.fa.gz\",     package = \"posDemux\" )  loader <- function(state) {     n_reads_per_chunk <- 1e4     if (!state$output_table_initialized) {         message(\"Starting to load sequences\")     }     chunk <- Biostrings::readDNAStringSet(         filepath = input_fasta,         format = \"fasta\",         nrec = n_reads_per_chunk,         skip = state$total_reads     )     n_reads_in_chunk <- length(chunk)     if (n_reads_in_chunk == 0L && state$output_table_initialized) {         # The case when the initial chunk is empty is given         # special treatment since         # we want to create the table regardless         # No more reads to process, make the outer framework return         final_res <- list(             state = state,             sequences = NULL,             should_terminate = TRUE         )         message(\"Done demultiplexing\")         return(final_res)     }     state$total_reads <- state$total_reads + n_reads_in_chunk     list(         state = state,         sequences = chunk,         should_terminate = FALSE     ) }"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"the-archiver","dir":"Articles","previous_headings":"Streaming using custom callbacks","what":"The archiver","title":"Streaming data into the demultiplexer","text":"archiver state obtained loader first argument results filter_demultiplex_res() chunk second argument. return value state provide loader continues next chunk.","code":"output_umi_file <- tempfile(pattern = \"umi.fa\", fileext = \".txt\") custom_output_table <- tempfile(     pattern = \"barcode_table_custom\",     fileext = \".txt\" ) archiver <- function(state, filtered_res) {     barcode_matrix <- filtered_res$demultiplex_res$assigned_barcodes     barcode_names <- colnames(barcode_matrix)     read_names <- rownames(barcode_matrix)     # If the table has no rows, we may risk getting a NULL value     if (is.null(read_names)) {         read_names <- character()     }     barcode_table <- as.data.frame(barcode_matrix)     read_name_table <- data.frame(read = read_names)     umis <- filtered_res$demultiplex_res$payload$UMI      chunk_table <- cbind(read_name_table, barcode_table)     if (!state$output_table_initialized) {         append <- FALSE         state$output_table_initialized <- TRUE     } else {         append <- TRUE     }      Biostrings::writeXStringSet(         umis,         filepath = output_umi_file, append = TRUE     )     readr::write_tsv(         x = chunk_table,         file = custom_output_table,         append = append,         col_names = !append,         eol = \"\\n\"     )     state <- within(state, {         demultiplexed_reads <- demultiplexed_reads + nrow(barcode_matrix)         paste0(             \"Processed {total_reads} reads,\", \" \",             \"successfully demultiplexed {demultiplexed_reads} reads so far...\"         ) %>%             glue::glue() %>%             message()     })     state }"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"putting-it-all-together","dir":"Articles","previous_headings":"Streaming using custom callbacks","what":"Putting it all together","title":"Streaming data into the demultiplexer","text":"initial state callbacks defined, now ready put use:","code":"custom_summary_res <- streaming_demultiplex(     state_init = custom_state_init,     loader = loader,     archiver = archiver,     barcodes = barcodes,     allowed_mismatches = 1L,     segments = sequence_annotation,     segment_lengths = segment_lengths ) #> Starting to load sequences #> Processed 10000 reads, successfully demultiplexed 9117 reads so far... #> Processed 20000 reads, successfully demultiplexed 18259 reads so far... #> Processed 30000 reads, successfully demultiplexed 27362 reads so far... #> Processed 40000 reads, successfully demultiplexed 36487 reads so far... #> Processed 50000 reads, successfully demultiplexed 45629 reads so far... #> Processed 56895 reads, successfully demultiplexed 51906 reads so far... #> Done demultiplexing"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"verifying-results","dir":"Articles","previous_headings":"Streaming using custom callbacks","what":"Verifying results","title":"Streaming data into the demultiplexer","text":"finally load files wrote order verify contain desire. load barcode table: UMI sequences:","code":"readr::read_tsv(custom_output_table, show_col_types = FALSE) #> # A tibble: 51,906 × 4 #>    read   bc3    bc2    bc1    #>    <chr>  <chr>  <chr>  <chr>  #>  1 seq_1  bc3_57 bc2_51 bc1_94 #>  2 seq_2  bc3_72 bc2_94 bc1_95 #>  3 seq_4  bc3_85 bc2_81 bc1_17 #>  4 seq_5  bc3_49 bc2_64 bc1_77 #>  5 seq_6  bc3_3  bc2_45 bc1_33 #>  6 seq_7  bc3_17 bc2_57 bc1_71 #>  7 seq_8  bc3_69 bc2_65 bc1_49 #>  8 seq_9  bc3_38 bc2_87 bc1_83 #>  9 seq_10 bc3_76 bc2_36 bc1_85 #> 10 seq_11 bc3_15 bc2_84 bc1_16 #> # ℹ 51,896 more rows Biostrings::readDNAStringSet(output_umi_file, format = \"fasta\") #> DNAStringSet object of length 51906: #>         width seq                                           names                #>     [1]     7 GCCTAAC                                       seq_1 #>     [2]     7 CCAAGCG                                       seq_2 #>     [3]     7 CCTAACG                                       seq_4 #>     [4]     7 GCTCGTC                                       seq_5 #>     [5]     7 TGGAGAA                                       seq_6 #>     ...   ... ... #> [51902]     7 ATGGATC                                       seq_56890 #> [51903]     7 ACGGCTT                                       seq_56891 #> [51904]     7 ATGAGCG                                       seq_56892 #> [51905]     7 ACCTGCG                                       seq_56893 #> [51906]     7 GCCTTGA                                       seq_56895"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"reproducibility","dir":"Articles","previous_headings":"","what":"Reproducibility","title":"Streaming data into the demultiplexer","text":"posDemux package made possible thanks : R BiocStyle knitr RefManageR rmarkdown sessioninfo testthat package developed using biocthis. R session information:","code":"#> ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────── #>  setting  value #>  version  R Under development (unstable) (2025-12-14 r89168) #>  os       Ubuntu 24.04.3 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  C.UTF-8 #>  ctype    C.UTF-8 #>  tz       UTC #>  date     2025-12-16 #>  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown) #>  quarto   NA #>  #> ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────── #>  package              * version   date (UTC) lib source #>  abind                  1.4-8     2024-09-12 [1] RSPM #>  assertthat             0.2.1     2019-03-21 [1] RSPM #>  backports              1.5.0     2024-05-23 [1] RSPM #>  bibtex                 0.5.1     2023-01-26 [1] RSPM #>  Biobase                2.71.0    2025-10-30 [1] Bioconduc~ #>  BiocGenerics         * 0.57.0    2025-10-30 [1] Bioconduc~ #>  BiocManager            1.30.27   2025-11-14 [1] RSPM #>  BiocParallel           1.45.0    2025-10-30 [1] Bioconduc~ #>  BiocStyle            * 2.39.0    2025-10-30 [1] Bioconduc~ #>  Biostrings           * 2.79.2    2025-11-05 [1] Bioconduc~ #>  bit                    4.6.0     2025-03-06 [1] RSPM #>  bit64                  4.6.0-1   2025-01-16 [1] RSPM #>  bitops                 1.0-9     2024-10-03 [1] RSPM #>  blob                   1.2.4     2023-03-17 [1] RSPM #>  bookdown               0.46      2025-12-05 [1] RSPM #>  bslib                  0.9.0     2025-01-30 [1] RSPM #>  cachem                 1.1.0     2024-05-16 [1] RSPM #>  chunked              * 0.6.1     2025-10-02 [1] RSPM #>  cigarillo              1.1.0     2025-10-31 [1] Bioconduc~ #>  cli                    3.6.5     2025-04-23 [1] RSPM #>  codetools              0.2-20    2024-03-31 [3] CRAN (R 4.6.0) #>  crayon                 1.5.3     2024-06-20 [1] RSPM #>  DBI                  * 1.2.3     2024-06-02 [1] RSPM #>  dbplyr                 2.5.1     2025-09-10 [1] RSPM #>  DelayedArray           0.37.0    2025-10-31 [1] Bioconduc~ #>  deldir                 2.0-4     2024-02-28 [1] RSPM #>  desc                   1.4.3     2023-12-10 [1] RSPM #>  digest                 0.6.39    2025-11-19 [1] RSPM #>  dplyr                * 1.1.4     2023-11-17 [1] RSPM #>  evaluate               1.0.5     2025-08-27 [1] RSPM #>  farver                 2.1.2     2024-05-13 [1] RSPM #>  fastmap                1.2.0     2024-05-15 [1] RSPM #>  fs                     1.6.6     2025-04-12 [1] RSPM #>  generics             * 0.1.4     2025-05-09 [1] RSPM #>  GenomicAlignments      1.47.0    2025-10-31 [1] Bioconduc~ #>  GenomicRanges          1.63.1    2025-12-08 [1] Bioconduc~ #>  ggplot2                4.0.1     2025-11-14 [1] RSPM #>  glue                   1.8.0     2024-09-30 [1] RSPM #>  gtable                 0.3.6     2024-10-25 [1] RSPM #>  hms                    1.1.4     2025-10-17 [1] RSPM #>  htmltools              0.5.9     2025-12-04 [1] RSPM #>  htmlwidgets            1.6.4     2023-12-06 [1] RSPM #>  httpuv                 1.6.16    2025-04-16 [1] RSPM #>  httr                   1.4.7     2023-08-15 [1] RSPM #>  hwriter                1.3.2.1   2022-04-08 [1] RSPM #>  interp                 1.1-6     2024-01-26 [1] RSPM #>  IRanges              * 2.45.0    2025-10-31 [1] Bioconduc~ #>  jpeg                   0.1-11    2025-03-21 [1] RSPM #>  jquerylib              0.1.4     2021-04-26 [1] RSPM #>  jsonlite               2.0.0     2025-03-27 [1] RSPM #>  knitr                  1.50      2025-03-16 [1] RSPM #>  LaF                    0.8.6     2024-12-13 [1] RSPM #>  later                  1.4.4     2025-08-27 [1] RSPM #>  lattice                0.22-7    2025-04-02 [3] CRAN (R 4.6.0) #>  latticeExtra           0.6-31    2025-09-10 [1] RSPM #>  lifecycle              1.0.4     2023-11-07 [1] RSPM #>  lubridate              1.9.4     2024-12-08 [1] RSPM #>  magrittr             * 2.0.4     2025-09-12 [1] RSPM #>  Matrix                 1.7-4     2025-08-28 [3] CRAN (R 4.6.0) #>  MatrixGenerics         1.23.0    2025-10-30 [1] Bioconduc~ #>  matrixStats            1.5.0     2025-01-07 [1] RSPM #>  memoise                2.0.1     2021-11-26 [1] RSPM #>  mime                   0.13      2025-03-17 [1] RSPM #>  otel                   0.2.0     2025-08-29 [1] RSPM #>  pillar                 1.11.1    2025-09-17 [1] RSPM #>  pkgconfig              2.0.3     2019-09-22 [1] RSPM #>  pkgdown                2.2.0     2025-11-06 [1] RSPM #>  plyr                   1.8.9     2023-10-02 [1] RSPM #>  png                    0.1-8     2022-11-29 [1] RSPM #>  posDemux             * 0.99.8    2025-12-16 [1] local #>  promises               1.5.0     2025-11-01 [1] RSPM #>  purrr                * 1.2.0     2025-11-04 [1] RSPM #>  pwalign                1.7.0     2025-10-31 [1] Bioconduc~ #>  R6                     2.6.1     2025-02-15 [1] RSPM #>  ragg                   1.5.0     2025-09-02 [1] RSPM #>  RColorBrewer           1.1-3     2022-04-03 [1] RSPM #>  Rcpp                   1.1.0.8.1 2025-12-08 [1] RSPM #>  readr                  2.1.6     2025-11-14 [1] RSPM #>  RefManageR           * 1.4.0     2022-09-30 [1] RSPM #>  rlang                  1.1.6     2025-04-11 [1] RSPM #>  rmarkdown              2.30      2025-09-28 [1] RSPM #>  Rsamtools              2.27.0    2025-10-31 [1] Bioconduc~ #>  RSQLite                2.4.5     2025-11-30 [1] RSPM #>  S4Arrays               1.11.1    2025-11-25 [1] Bioconduc~ #>  S4Vectors            * 0.49.0    2025-10-30 [1] Bioconduc~ #>  S7                     0.2.1     2025-11-14 [1] RSPM #>  sass                   0.4.10    2025-04-11 [1] RSPM #>  scales                 1.4.0     2025-04-24 [1] RSPM #>  Seqinfo              * 1.1.0     2025-10-31 [1] Bioconduc~ #>  sessioninfo          * 1.2.3     2025-02-05 [1] RSPM #>  shiny                  1.12.1    2025-12-09 [1] RSPM #>  ShortRead              1.69.2    2025-11-05 [1] Bioconduc~ #>  SparseArray            1.11.9    2025-12-10 [1] Bioconduc~ #>  stringi                1.8.7     2025-03-27 [1] RSPM #>  stringr                1.6.0     2025-11-04 [1] RSPM #>  SummarizedExperiment   1.41.0    2025-10-31 [1] Bioconduc~ #>  systemfonts            1.3.1     2025-10-01 [1] RSPM #>  textshaping            1.0.4     2025-10-10 [1] RSPM #>  tibble                 3.3.0     2025-06-08 [1] RSPM #>  tidyselect             1.2.1     2024-03-11 [1] RSPM #>  timechange             0.3.0     2024-01-18 [1] RSPM #>  tzdb                   0.5.0     2025-03-15 [1] RSPM #>  utf8                   1.2.6     2025-06-08 [1] RSPM #>  vctrs                  0.6.5     2023-12-01 [1] RSPM #>  vroom                  1.6.7     2025-11-28 [1] RSPM #>  withr                  3.0.2     2024-10-28 [1] RSPM #>  xfun                   0.54      2025-10-30 [1] RSPM #>  xml2                   1.5.1     2025-12-01 [1] RSPM #>  xtable                 1.8-4     2019-04-21 [1] RSPM #>  XVector              * 0.51.0    2025-10-31 [1] Bioconduc~ #>  yaml                   2.3.12    2025-12-10 [1] RSPM #>  #>  [1] /home/runner/work/_temp/Library #>  [2] /opt/R/devel/lib/R/site-library #>  [3] /opt/R/devel/lib/R/library #>  * ── Packages attached to the search path. #>  #> ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────"},{"path":"https://yaccos.github.io/posDemux/articles/streaming.html","id":"bibliography","dir":"Articles","previous_headings":"","what":"Bibliography","title":"Streaming data into the demultiplexer","text":"vignette generated using BiocStyle knitr rmarkdown running behind scenes.","code":""},{"path":"https://yaccos.github.io/posDemux/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jakob Peder Pettersen. Author, maintainer. Centre new antibacterial strategies (CANS). Funder.","code":""},{"path":"https://yaccos.github.io/posDemux/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pettersen J (2025). posDemux: Positional combinatorial sequence demultiplexer. R package version 0.99.8, https://github.com/yaccos/posDemux.","code":"@Manual{,   title = {posDemux: Positional combinatorial sequence demultiplexer},   author = {Jakob Peder Pettersen},   year = {2025},   note = {R package version 0.99.8},   url = {https://github.com/yaccos/posDemux}, }"},{"path":"https://yaccos.github.io/posDemux/index.html","id":"posdemux","dir":"","previous_headings":"","what":"Positional combinatorial sequence demultiplexer","title":"Positional combinatorial sequence demultiplexer","text":"goal posDemux provide tools tools handling reads combinatorial barcodes, multiple adapter regions. includes utilities demultiplexing, sequence segmenting filtering. package intended work single-cell RNA-seq data multiple barcoding (e.g. SPLiT-seq PETRI-seq).","code":""},{"path":"https://yaccos.github.io/posDemux/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Positional combinatorial sequence demultiplexer","text":"can install development version posDemux GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"yaccos/posDemux\")"},{"path":"https://yaccos.github.io/posDemux/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Positional combinatorial sequence demultiplexer","text":"Please see package vignettes.","code":""},{"path":"https://yaccos.github.io/posDemux/index.html","id":"issues","dir":"","previous_headings":"","what":"Issues","title":"Positional combinatorial sequence demultiplexer","text":"Please use repository’s issue tracker make package work suggestions improvements.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/bc_to_freq_cutoff.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert between cutoff types — bc_to_freq_cutoff","title":"Convert between cutoff types — bc_to_freq_cutoff","text":"least two ways specify cutoff use selecting barcode combinations (cells) analysis. One way specify number barcode combinations keep, effectively keeping given number barcode combinations highest frequencies. way specify frequency cutoff directly without regard number barcode combination keep. former case, bc_to_freq_cutoff() used find corresponding frequency cutoff, whereas latter case freq_to_bc_cutoff() used find corresponding barcode cutoff.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/bc_to_freq_cutoff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert between cutoff types — bc_to_freq_cutoff","text":"","code":"bc_to_freq_cutoff(freq_table, cutoff)  freq_to_bc_cutoff(freq_table, cutoff)"},{"path":"https://yaccos.github.io/posDemux/reference/bc_to_freq_cutoff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert between cutoff types — bc_to_freq_cutoff","text":"freq_table frequency table create_freq_table(). case table derived another source, must sorted descending order frequency. cutoff Integer vector, cutoff values converted.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/bc_to_freq_cutoff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert between cutoff types — bc_to_freq_cutoff","text":"Integer, converted cutoff values.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/bc_to_freq_cutoff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert between cutoff types — bc_to_freq_cutoff","text":"edge case barcode threshold zero, frequency cutoff set maximum frequency table plus one. feature makes sure cutoff line visible frequency plot.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/bc_to_freq_cutoff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert between cutoff types — bc_to_freq_cutoff","text":"","code":"library(purrr) library(Biostrings) #> Loading required package: BiocGenerics #> Loading required package: generics #>  #> Attaching package: ‘generics’ #> The following objects are masked from ‘package:base’: #>  #>     as.difftime, as.factor, as.ordered, intersect, is.element, setdiff, #>     setequal, union #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, is.unsorted, lapply, #>     mapply, match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, #>     rank, rbind, rownames, sapply, saveRDS, table, tapply, unique, #>     unsplit, which.max, which.min #> Loading required package: S4Vectors #> Loading required package: stats4 #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #>  #> Attaching package: ‘IRanges’ #> The following object is masked from ‘package:purrr’: #>  #>     reduce #> Loading required package: XVector #>  #> Attaching package: ‘XVector’ #> The following object is masked from ‘package:purrr’: #>  #>     compact #> Loading required package: Seqinfo #>  #> Attaching package: ‘Biostrings’ #> The following object is masked from ‘package:base’: #>  #>     strsplit input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\",     package = \"posDemux\") reads <- readDNAStringSet(input_fastq, format = \"fastq\") barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\", c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\",     bc3 = \"bc3.fa\"), package = \"posDemux\") names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) demultiplex_res <- posDemux::combinatorial_demultiplex(     reads, barcodes = barcodes, segments = sequence_annotation,     segment_lengths = segment_lengths) filtered_res <- filter_demultiplex_res(demultiplex_res, allowed_mismatches = 1L) freq_table <- create_freq_table(filtered_res$demultiplex_res$assigned_barcodes)  bc_cutoff <- c(100L, 204L, 50L, 655L) freq_cutoff <- bc_to_freq_cutoff(freq_table, bc_cutoff) # Note: The reconstructed barcode cutoff is not equal to # the original due to ties in the frequency table reconstructed_bc_cutoff <- freq_to_bc_cutoff(freq_table, freq_cutoff) # The frequency cutoff is still preserved through these conversions reconstruced_freq_cutoff <- bc_to_freq_cutoff(     freq_table, reconstructed_bc_cutoff)"},{"path":"https://yaccos.github.io/posDemux/reference/combinatorial_demultiplex.html","id":null,"dir":"Reference","previous_headings":"","what":"Combinatorial demultiplexer — combinatorial_demultiplex","title":"Combinatorial demultiplexer — combinatorial_demultiplex","text":"function performs segmenting sequences combinatorial demultiplexing segmenting sequences. sequences structure defined argument segments corresponding lengths segment_lengths. segmentation extraction can take place either end, single middle segment can variadic length. three types segments: Adapter, Barcode Payload. adapter trimmed ignored, barcode used demultiplexing, payload kept segmenting demultiplexing returned function. multiple payload segments, segment constitutes segment list. type stability reasons, list returned also zero one payload segments. barcodes can positioned either end sequences, barcode can (obvious reasons) variadic length.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/combinatorial_demultiplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combinatorial demultiplexer — combinatorial_demultiplex","text":"","code":"combinatorial_demultiplex(sequences, barcodes, segments, segment_lengths)"},{"path":"https://yaccos.github.io/posDemux/reference/combinatorial_demultiplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combinatorial demultiplexer — combinatorial_demultiplex","text":"sequences XStringSet object, sequences demultiplexed. barcodes list XStringSet objects order appear sequences, barcodes used demultiplexing. barcodes XStringSet must length specified segment_lengths argument named. computational reasons, maximum possible length individual barcode 127. segments Character vector showing segments sequences 5' end 3' end. code applied follows: '': Adapter (often referred linker), trimmed ignored 'B': Barcode, used demultiplexing 'P': Payload, sequence kept trimming demultiplexing (e.g. cDNA UMI). vector named, determine names payload sets. Names barcode sets determined names argument barcodes (). segment_lengths Integer vector length segments, lengths segments provided order segments. one non-barcode segments can length set NA means considered variadic length segment.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/combinatorial_demultiplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combinatorial demultiplexer — combinatorial_demultiplex","text":"list following elements: assigned_barcodes: character matrix names assigned barcodes elements. rows correspond sequences columns barcode segments. mismatches: integer matrix number mismatches assigned barcodes sequences. rows correspond sequences columns barcode segments. payload: list XStringSet objects, containing results payload segment. barcodes: barcodes argument passed function. included order ease downstream processing.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/combinatorial_demultiplex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combinatorial demultiplexer — combinatorial_demultiplex","text":"two barcodes minimum number mismatches first one selected. therefore important choose error tolerance equal less redundancy barcodes. sequences assumed long enough segments extracted. Otherwise, error raised.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/combinatorial_demultiplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combinatorial demultiplexer — combinatorial_demultiplex","text":"","code":"library(purrr) library(Biostrings) sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),     package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet)  barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") reads <- readDNAStringSet(input_fastq, format = \"fastq\") demultiplex_res <- combinatorial_demultiplex(     reads, barcodes = barcodes, segments = sequence_annotation,     segment_lengths = segment_lengths     )"},{"path":"https://yaccos.github.io/posDemux/reference/create_freq_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Frequency table — create_freq_table","title":"Frequency table — create_freq_table","text":"Creates sorted frequency table observed barcode combinations. function indended used running filter_demultiplex_res() creating frequency plots, knee plots, selecting number barcodes include.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_freq_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Frequency table — create_freq_table","text":"","code":"create_freq_table(assigned_barcodes)"},{"path":"https://yaccos.github.io/posDemux/reference/create_freq_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Frequency table — create_freq_table","text":"assigned_barcodes character integer matrix, corresponding field assigned_barcodes combinatorial_demultiplex() field demultiplex_res$assigned_barcodes filter_demultiplex_res().","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_freq_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Frequency table — create_freq_table","text":"data frame row corresponds unique observed barcode combination. rows sorted descending order frequency. first columns specify barcode assignment (e.g bc3, bc2, bc1) last columns following: frequency: number reads barcode combination. cumulative_frequency: cumulative frequency barcode combination counted top. fraction: fraction reads barcode combination. cumulative_fraction: cumulative fraction barcode combination counted top.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_freq_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Frequency table — create_freq_table","text":"","code":"library(purrr) library(Biostrings) input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") reads <- readDNAStringSet(input_fastq, format = \"fastq\") barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),     package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) demultiplex_res <- posDemux::combinatorial_demultiplex(     reads, barcodes = barcodes, segments = sequence_annotation,     segment_lengths = segment_lengths     ) filtered_res <- filter_demultiplex_res(demultiplex_res, allowed_mismatches = 1L) freq_table <- create_freq_table(filtered_res$demultiplex_res$assigned_barcodes)"},{"path":"https://yaccos.github.io/posDemux/reference/create_summary_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a summary of match filtering — create_summary_res","title":"Create a summary of match filtering — create_summary_res","text":"create_summary_res() helper function order create summary demultiplexing following match filtering. designed invoked directly, results returned automatically filter_demultiplex_res(). returned object method printing result user-friendly manner.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_summary_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a summary of match filtering — create_summary_res","text":"","code":"create_summary_res(   retained,   barcodes,   assigned_barcodes,   allowed_mismatches,   mismatches )  # S3 method for class 'demultiplex_filter_summary' print(x, ...)"},{"path":"https://yaccos.github.io/posDemux/reference/create_summary_res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a summary of match filtering — create_summary_res","text":"retained Logical vector length number reads input demultiplexer. TRUE corresponding read retained. Corresponds field retained output filter_demultiplex_res(). barcodes list XStringSet objects, barcodes used demultiplexing. assigned_barcodes Character matrix assigned barcodes including onces within mismatch threshold. Corresponds field demultiplex_res$assigned_barcodes filter_demultiplex_res(). allowed_mismatches Integer vector length one length number barcode segments; threshold Hamming distance. reads number mismatches number barcodes filtered away. mismatches Integer matrix number mismatches assigned barcode. Corresponds field mismatches combinatorial_demultiplex(). x object class demultiplex_filter_summary create_summary_res(). ... Ignored","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_summary_res.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a summary of match filtering — create_summary_res","text":"create_summary_res() returns list S3 class demultiplex_filter_summary providing diagnostics filtering process. contains following fields: n_reads: total number reads dataset filtering. n_removed: number reads removed demultiplexing failed. n_barcode_sets: number barcode sets. n_barcode_combinations: possible number barcode combinations. n_unique_barcodes: number observed unique barcode combinations (.e. features may cells) detected filtering mismatches. n_estimated_features: estimated number features detected combination barcodes. number always greater equal n_unique_barcodes due barcode collisions. observed_collision_lambda: ratio observed barcode combinations divided total number possible barcode combinations. corrected_collision_lambda: ratio estimated number features total number possible barcode combinations. expected_collisions: statistically expected number barcode collisions precicely expected number observed barcodes correspond two features. barcode_summary: list containing summary barcode set. element contains following: width: width (number nucleotides) barcode set. n_barcodes: Number query barcodes. n_allowed_mismatches: Number allowed mismatches barcode set. n_removed: Number reads many mismatches barcode set. mismatch_frame: data.frame two columns, n_mismatches frequency showing number reads allowed number mismatches given barcode set. print() method returns output invisibly.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_summary_res.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a summary of match filtering — create_summary_res","text":"Following uniform distribution barcodes, expected number barcode collisions (observed barcodes combinations composed two features) given $$N\\left(1-e^{-\\lambda}-\\lambda e^{-\\lambda}\\right),$$ \\(N\\) number possible barcode combinations \\(\\lambda\\) summary referred collision lambda: $$\\lambda=\\frac{n}{N},$$ \\(n\\) number features. However, \\(n\\) unknown know many features originally due potential collisions. Utilizing fact expected observed number barcodes given $$N\\left(1-e^{-\\lambda}\\right),$$ can correct estimate \\(\\lambda\\) known value observed barcode combinations, thus estimate number features barcode collisions. unique feature can conceptually thought single cell transcripts, realistic datasets many features relatively small numbers reads artifacts unlikely correspond true cells.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/create_summary_res.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a summary of match filtering — create_summary_res","text":"","code":"library(purrr) library(Biostrings) input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") reads <- readDNAStringSet(input_fastq, format = \"fastq\") barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"), package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) demultiplex_res <- posDemux::combinatorial_demultiplex(     reads, barcodes = barcodes, segments = sequence_annotation,     segment_lengths = segment_lengths     ) filtered_res <- filter_demultiplex_res(demultiplex_res, allowed_mismatches = 1L) freq_table <- create_freq_table(filtered_res$demultiplex_res$assigned_barcodes) print(filtered_res$summary_res) #> Total number of reads: 56895  #> Number of reads failing to demultiplex: 4989 (8.77%)  #> Observed number of unique barcode combinations:978  #> Number of possible barcode combinations: 884736  #> Estimated number of features: 978.5  #> Observed feature to barcode ratio: 0.001105  #> Corrected feature to barcode ratio: 0.001106  #> Estimated number of observed barcode combinations #> corresponding to more than one feature: 0.5 (0.06%)  #> Number of barcode sets: 3  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc3  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51923 (91.26%)  #> Number of reads with 1 mismatches: 671 (1.18%)  #> Number of reads above mismatch threshold: 4301 (7.56%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc2  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51918 (91.25%)  #> Number of reads with 1 mismatches: 567 (1%)  #> Number of reads above mismatch threshold: 4410 (7.75%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc1  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51930 (91.27%)  #> Number of reads with 1 mismatches: 642 (1.13%)  #> Number of reads above mismatch threshold: 4323 (7.6%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   # This also works, but is usually not necessary to call directly alternative_summary_res <- create_summary_res(     retained = filtered_res$retained, barcodes = barcodes,     assigned_barcodes = filtered_res$demultiplex_res$assigned_barcodes,     allowed_mismatches = 1L, mismatches = demultiplex_res$mismatches     )"},{"path":"https://yaccos.github.io/posDemux/reference/filter_demultiplex_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter demultiplexed reads — filter_demultiplex_res","title":"Filter demultiplexed reads — filter_demultiplex_res","text":"Filters demultiplexed reads combinatorial_demultiplex() read exceeding number allowed mismatches barcodes removed. function gives diagnostic information number reads removed per barcode total number reads removed.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/filter_demultiplex_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter demultiplexed reads — filter_demultiplex_res","text":"","code":"filter_demultiplex_res(demultiplex_res, allowed_mismatches)"},{"path":"https://yaccos.github.io/posDemux/reference/filter_demultiplex_res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter demultiplexed reads — filter_demultiplex_res","text":"demultiplex_res Unprocessed output combinatorial_demultiplex(). allowed_mismatches Integer vector length one length number barcode segments; threshold Hamming distance. reads number mismatches number barcodes filtered away.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/filter_demultiplex_res.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter demultiplexed reads — filter_demultiplex_res","text":"list following elements: demultiplex_res: contents input argument demultiplex_res sequences filtered. retained: Logical vector length number reads input. TRUE corresponding read retained. Useful future filtering paired-end reads. summary_res: Result create_summary_res() called results filtering.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/filter_demultiplex_res.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter demultiplexed reads — filter_demultiplex_res","text":"value n_removed general equal sum n_removed_per_barcode since read can many mismatches multiple barcodes.","code":""},{"path":[]},{"path":"https://yaccos.github.io/posDemux/reference/filter_demultiplex_res.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter demultiplexed reads — filter_demultiplex_res","text":"","code":"library(purrr) library(Biostrings) input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") reads <- readDNAStringSet(input_fastq, format = \"fastq\") barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"), package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) demultiplex_res <- posDemux::combinatorial_demultiplex(     reads, barcodes = barcodes, segments = sequence_annotation,     segment_lengths = segment_lengths     ) filtered_res <- filter_demultiplex_res(demultiplex_res, allowed_mismatches = 1L) freq_table <- create_freq_table(filtered_res$demultiplex_res$assigned_barcodes) print(filtered_res$summary_res) #> Total number of reads: 56895  #> Number of reads failing to demultiplex: 4989 (8.77%)  #> Observed number of unique barcode combinations:978  #> Number of possible barcode combinations: 884736  #> Estimated number of features: 978.5  #> Observed feature to barcode ratio: 0.001105  #> Corrected feature to barcode ratio: 0.001106  #> Estimated number of observed barcode combinations #> corresponding to more than one feature: 0.5 (0.06%)  #> Number of barcode sets: 3  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc3  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51923 (91.26%)  #> Number of reads with 1 mismatches: 671 (1.18%)  #> Number of reads above mismatch threshold: 4301 (7.56%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc2  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51918 (91.25%)  #> Number of reads with 1 mismatches: 567 (1%)  #> Number of reads above mismatch threshold: 4410 (7.75%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  #> Barcode set: bc1  #> Barcode width: 7  #> Number of possible barcodes: 96  #> Number of allowed mismatches: 1  #> Number of reads with 0 mismatches: 51930 (91.27%)  #> Number of reads with 1 mismatches: 642 (1.13%)  #> Number of reads above mismatch threshold: 4323 (7.6%)  #> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   # This also works, but is usually not necessary to call directly alternative_summary_res <- create_summary_res(     retained = filtered_res$retained, barcodes = barcodes,     assigned_barcodes = filtered_res$demultiplex_res$assigned_barcodes,     allowed_mismatches = 1L, mismatches = demultiplex_res$mismatches     )"},{"path":"https://yaccos.github.io/posDemux/reference/freq_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Diagnostic plots from demultiplexing — freq_plot","title":"Diagnostic plots from demultiplexing — freq_plot","text":"Diagnostic plots determining effect barcode cutoff. freq_plot() shows histogram distribution plot number reads barcode combination, whereas knee_plot() shows cumulative fraction reads ranked frequency barcode combinations descending order.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/freq_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Diagnostic plots from demultiplexing — freq_plot","text":"","code":"freq_plot(   freq_table,   cutoff = NULL,   type = \"histogram\",   log_scale_x = TRUE,   log_scale_y = FALSE,   scale_by_reads = FALSE )  knee_plot(freq_table, cutoff = NULL)"},{"path":"https://yaccos.github.io/posDemux/reference/freq_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Diagnostic plots from demultiplexing — freq_plot","text":"freq_table frequency table create_freq_table(). cutoff Optional scalar numeric, x-coordinate drawing vertical dashed line plots order indicate cutoff. Please note argument interpreted literally, meaning order correctly display cutoff type plots, cutoff value transformed. order safely convert two types cutoffs, use functions bc_to_freq_cutoff() freq_to_bc_cutoff(). type type frequency plot make, either 'histogram' 'density'. log_scale_x Logical: log scale applied x-axis frequency plot? log_scale_y Logical: log scale applied y-axis frequency plot? scale_by_reads Logical: y-axis plot scaled number reads x-axis?","code":""},{"path":"https://yaccos.github.io/posDemux/reference/freq_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Diagnostic plots from demultiplexing — freq_plot","text":"ggplot object can displayed immediately modified.","code":""},{"path":[]},{"path":"https://yaccos.github.io/posDemux/reference/freq_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Diagnostic plots from demultiplexing — freq_plot","text":"","code":"library(purrr) library(Biostrings) input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") reads <- readDNAStringSet(input_fastq, format = \"fastq\") barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",      c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),     package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) demultiplex_res <- posDemux::combinatorial_demultiplex(     reads, barcodes = barcodes, segments = sequence_annotation,     segment_lengths = segment_lengths) filtered_res <- filter_demultiplex_res(demultiplex_res, allowed_mismatches = 1L) freq_table <- create_freq_table(filtered_res$demultiplex_res$assigned_barcodes)  bc_cutoff <- 500L # Notice the bend (knee) of the curve knee_plot(freq_table, cutoff = bc_cutoff)   # Note that we must convert the cutoff when constructing the frequency plot freq_cutoff <- bc_to_freq_cutoff(freq_table, bc_cutoff)  # This is the most basic type of frequency plot which can be made, # but it is a bit hard to interpret whether a selected cutoff is sensible freq_plot(     freq_table, cutoff = freq_cutoff, type = \"histogram\",     log_scale_x = FALSE, log_scale_y = FALSE, scale_by_reads = FALSE) #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`.   # For most practical purposes, this is the most informative version freq_plot(freq_table, cutoff = freq_cutoff, type = \"density\",     log_scale_x = TRUE, log_scale_y = FALSE,     scale_by_reads = TRUE)"},{"path":"https://yaccos.github.io/posDemux/reference/interactive_bc_cutoff.html","id":null,"dir":"Reference","previous_headings":"","what":"Interactive cutoff selection — interactive_bc_cutoff","title":"Interactive cutoff selection — interactive_bc_cutoff","text":"Returns interactive Shiny application determining cutoff knee plot barcode frequency plot. user select appropriate number barcode combinations (.e. distinct cells) keep analysis. Usually, done aiming 'knee' knee plot order keep reads, time removing barcode combinations either artifacts broken cells.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/interactive_bc_cutoff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interactive cutoff selection — interactive_bc_cutoff","text":"","code":"interactive_bc_cutoff(freq_table)"},{"path":"https://yaccos.github.io/posDemux/reference/interactive_bc_cutoff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interactive cutoff selection — interactive_bc_cutoff","text":"freq_table frequency table create_freq_table().","code":""},{"path":"https://yaccos.github.io/posDemux/reference/interactive_bc_cutoff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interactive cutoff selection — interactive_bc_cutoff","text":"shiny.appobj launches printed returns last selected cutoff (invisibly) stops.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/interactive_bc_cutoff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interactive cutoff selection — interactive_bc_cutoff","text":"","code":"if (interactive()) {     library(purrr)     library(shiny)     library(Biostrings)     input_fastq <- system.file(         \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\")     reads <- readDNAStringSet(input_fastq, format = \"fastq\")     barcode_files <- system.file(         \"extdata/PETRI-seq_barcodes\",          c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),         package = \"posDemux\"         )     names(barcode_files) <- paste0(\"bc\", 1L:3L)     barcode_index <- map(barcode_files, readDNAStringSet)     barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")]     sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\")     segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_)     demultiplex_res <- posDemux::combinatorial_demultiplex(         reads, barcodes = barcodes, segments = sequence_annotation,         segment_lengths = segment_lengths         )     filtered_res <- filter_demultiplex_res(         demultiplex_res, allowed_mismatches = 1L)     freq_table <- create_freq_table(         filtered_res$demultiplex_res$assigned_barcodes)     selection_app <- interactive_bc_cutoff(freq_table)     selected_bc_cutoff <- runApp(selection_app) }"},{"path":"https://yaccos.github.io/posDemux/reference/posDemux.html","id":null,"dir":"Reference","previous_headings":"","what":"Utilities for segmented sequences with combinatorial barcoding — posDemux","title":"Utilities for segmented sequences with combinatorial barcoding — posDemux","text":"Provides tools handling reads combinatorial barcodes, multiple adapter regions. includes utilities demultiplexing, sequence segmenting filtering. package intended work single-cell RNA-seq data multiple barcoding (e.g. SPLiT-seq PETRI-seq).","code":""},{"path":"https://yaccos.github.io/posDemux/reference/posDemux.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Utilities for segmented sequences with combinatorial barcoding — posDemux","text":"Jakob Peder Pettersen jakobpeder.pettersen@gmail.com","code":""},{"path":"https://yaccos.github.io/posDemux/reference/row_match.html","id":null,"dir":"Reference","previous_headings":"","what":"Row matching of tables — row_match","title":"Row matching of tables — row_match","text":"function extends functionality %% finding rows first argument exist second.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/row_match.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Row matching of tables — row_match","text":"","code":"row_match(x, table)"},{"path":"https://yaccos.github.io/posDemux/reference/row_match.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Row matching of tables — row_match","text":"x matrix data frame rows matched. Typically, matrix assigned barcodes read. table matrix data frame rows matched . Typically, top portion frequency table.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/row_match.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Row matching of tables — row_match","text":"Logical vector, row x, row found table?","code":""},{"path":"https://yaccos.github.io/posDemux/reference/row_match.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Row matching of tables — row_match","text":"function intended used data frames containing just barcodes, intersection column names used matching. opposed base::match(), function implemented efficiently converting row numeric encoding matching. technical reasons, permitted product number unique values columns table exceed \\(2^{32}-1\\approx 2.1\\cdot 10^{9}\\).","code":""},{"path":[]},{"path":"https://yaccos.github.io/posDemux/reference/row_match.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Row matching of tables — row_match","text":"","code":"barcode_table <- data.frame(     read = c(\"seq_1\", \"seq_2\", \"seq_3\", \"seq_4\"),     bc1 = c(\"A\", \"B\", \"C\", \"B\"),     bc2 = c(\"A\", \"C\", \"A\", \"A\")     )  freq_table <- data.frame(     bc1 = c(\"B\", \"B\", \"C\", \"A\"),     bc2 = c(\"A\", \"C\", \"A\", \"A\"),     frequency = c(200L, 100L, 50L, 10L)     )  freq_cutoff <- 100L  selected_freq_table <- freq_table[freq_table$frequency >= freq_cutoff, ]  selected_rows <- row_match(barcode_table, selected_freq_table) selected_barcode_table <- barcode_table[selected_rows, ]"},{"path":"https://yaccos.github.io/posDemux/reference/streaming_callbacks.html","id":null,"dir":"Reference","previous_headings":"","what":"Suggested setup for FASTQ streaming — streaming_callbacks","title":"Suggested setup for FASTQ streaming — streaming_callbacks","text":"Even though user can define arguments state_init, loader, archiver streaming_demultiplex(), approach recommended advanced users. functions defines premade combinations three arguments suitable cases. loader streams FASTQ file (multiple files also supported) archiver outputs data frame file consisting read name (read), sequences payloads (e.g. UMI), barcode assignments (c('bc3','bc2','bc1')).","code":""},{"path":"https://yaccos.github.io/posDemux/reference/streaming_callbacks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suggested setup for FASTQ streaming — streaming_callbacks","text":"","code":"streaming_callbacks(   input_file,   output_table_file,   chunk_size = 1e+06,   verbose = TRUE,   min_width = NULL )"},{"path":"https://yaccos.github.io/posDemux/reference/streaming_callbacks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suggested setup for FASTQ streaming — streaming_callbacks","text":"input_file character vector containing paths FASTQ files used demultiplexing. Often one file, multiple files supported demultiplexing data multiple lanes require merging lanes first. output_table_file path output barcode table written. chunk_size Integer, number reads process chunk. verbose Logical scalar: progress displayed? min_width Optional integer scalar: Minimum width sequences keep. reads shorter , warning emitted reads removed ignored thus appear statistics. data loader supposed used length filter, option like escape hatch able deal sequences properly filtered beforehand.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/streaming_callbacks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Suggested setup for FASTQ streaming — streaming_callbacks","text":"list following elements, intended used corresponding arguments streaming_demultiplex(): state_init loader archiver","code":""},{"path":"https://yaccos.github.io/posDemux/reference/streaming_callbacks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Suggested setup for FASTQ streaming — streaming_callbacks","text":"read names spaces , loader keep portion read name preceding first space. due Illumina platform's behavior encoding sequencing direction (forward reverse) past space. Keeping read names space usually desirable makes resulting barcode table confusing makes difficult group forward reverse reads together afterwards.","code":""},{"path":[]},{"path":"https://yaccos.github.io/posDemux/reference/streaming_callbacks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Suggested setup for FASTQ streaming — streaming_callbacks","text":"","code":"library(purrr) library(Biostrings) input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") output_barcode_table <- tempfile(pattern = \"barcode_table\", fileext = \".txt\")  callbacks <- streaming_callbacks(     input_file = input_fastq, output_table_file = output_barcode_table,     chunk_size = 10000, verbose = TRUE) barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),     package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) streaming_summary_res <- streaming_demultiplex(     state_init = callbacks$state_init, loader = callbacks$loader,     archiver = callbacks$archiver, barcodes = barcodes, allowed_mismatches = 1L,     segments = sequence_annotation, segment_lengths = segment_lengths     ) #> Tue Dec 16 10:16:13 2025 => Initializing FASTQ stream and output table #> Tue Dec 16 10:16:13 2025 => Streaming FASTQ input file /home/runner/work/_temp/Library/posDemux/extdata/PETRI-seq_forward_reads.fq.gz #> Tue Dec 16 10:16:17 2025 => Processed 10000 reads, successfully demultiplexed 9117 reads so far... #> Tue Dec 16 10:16:18 2025 => Processed 20000 reads, successfully demultiplexed 18259 reads so far... #> Tue Dec 16 10:16:18 2025 => Processed 30000 reads, successfully demultiplexed 27362 reads so far... #> Tue Dec 16 10:16:18 2025 => Processed 40000 reads, successfully demultiplexed 36487 reads so far... #> Tue Dec 16 10:16:18 2025 => Processed 50000 reads, successfully demultiplexed 45629 reads so far... #> Tue Dec 16 10:16:18 2025 => Processed 56895 reads, successfully demultiplexed 51906 reads so far... #> Tue Dec 16 10:16:18 2025 => Done demultiplexing"},{"path":"https://yaccos.github.io/posDemux/reference/streaming_demultiplex.html","id":null,"dir":"Reference","previous_headings":"","what":"Demultiplexing with streaming — streaming_demultiplex","title":"Demultiplexing with streaming — streaming_demultiplex","text":"function provides interface combinatorial_demultiplex() filter_demultiplex_res() reads streamed chunks instead load everything , hence reducing memory consumption. accepts two functions called per chunk: data loader function producing sequences chunk archiver writing results file.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/streaming_demultiplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demultiplexing with streaming — streaming_demultiplex","text":"","code":"streaming_demultiplex(   state_init,   loader,   archiver,   barcodes,   allowed_mismatches,   segments,   segment_lengths )"},{"path":"https://yaccos.github.io/posDemux/reference/streaming_demultiplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Demultiplexing with streaming — streaming_demultiplex","text":"state_init initial state pass loader. loader Function loading reads. signature f(state), state user-defined object initialized state_init subsequent iterations taken state field output archiver. return value list following fields: state: state passed archiver. sequences: XStringSet object, sequences demultiplexed current chunk. should_terminate: scalar logical. TRUE, demultiplexing process terminates final results returned. Notice termination happens sequences final call loader demultiplexed. archiver Function taking care archiving demultiplexed results. arguments : state: state process returned loader. filtered_res: output running combinatorial_demultiplex() filter_demultiplex_res() data expect field summary_res missing. output state object fed next call loader. barcodes list XStringSet objects order appear sequences, barcodes used demultiplexing. barcodes XStringSet must length specified segment_lengths argument named. computational reasons, maximum possible length individual barcode 127. allowed_mismatches Integer vector length one length number barcode segments; threshold Hamming distance. reads number mismatches number barcodes filtered away. segments Character vector showing segments sequences 5' end 3' end. code applied follows: '': Adapter (often referred linker), trimmed ignored 'B': Barcode, used demultiplexing 'P': Payload, sequence kept trimming demultiplexing (e.g. cDNA UMI). vector named, determine names payload sets. Names barcode sets determined names argument barcodes (). segment_lengths Integer vector length segments, lengths segments provided order segments. one non-barcode segments can length set NA means considered variadic length segment.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/streaming_demultiplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Demultiplexing with streaming — streaming_demultiplex","text":"list three elements: freq_table: frequency table reads, akin output create_freq_table(). summary_res: summary result match filtering reads per create_summary_res(). state_final: final state object returned loader.","code":""},{"path":"https://yaccos.github.io/posDemux/reference/streaming_demultiplex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Demultiplexing with streaming — streaming_demultiplex","text":"data loader decides size chunk. framework provide restriction state object, loader archiver must written state objects return compatible. Since data loader alone decides terminate, bad terminations crieria can cause runaway loop. Usually, useful progress tracker many reads demultiplexed. framework implement , typically implemented archiver loader. technical reasons, possible streaming number possible barcode combinations exceeds \\(2^{32}-1\\approx 2.1\\cdot 10^{9}\\).","code":""},{"path":[]},{"path":"https://yaccos.github.io/posDemux/reference/streaming_demultiplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Demultiplexing with streaming — streaming_demultiplex","text":"","code":"library(purrr) library(Biostrings) input_fastq <- system.file(     \"extdata\", \"PETRI-seq_forward_reads.fq.gz\", package = \"posDemux\") output_barcode_table <- tempfile(pattern = \"barcode_table\", fileext = \".txt\")  callbacks <- streaming_callbacks(     input_file = input_fastq, output_table_file = output_barcode_table,     chunk_size = 10000, verbose = TRUE) barcode_files <- system.file(     \"extdata/PETRI-seq_barcodes\",     c(bc1 = \"bc1.fa\", bc2 = \"bc2.fa\", bc3 = \"bc3.fa\"),     package = \"posDemux\"     ) names(barcode_files) <- paste0(\"bc\", 1L:3L) barcode_index <- map(barcode_files, readDNAStringSet) barcodes <- barcode_index[c(\"bc3\", \"bc2\", \"bc1\")] sequence_annotation <- c(UMI = \"P\", \"B\", \"A\", \"B\", \"A\", \"B\", \"A\") segment_lengths <- c(7L, 7L, 15L, 7L, 14L, 7L, NA_integer_) streaming_summary_res <- streaming_demultiplex(     state_init = callbacks$state_init, loader = callbacks$loader,     archiver = callbacks$archiver, barcodes = barcodes, allowed_mismatches = 1L,     segments = sequence_annotation, segment_lengths = segment_lengths     ) #> Tue Dec 16 10:16:19 2025 => Initializing FASTQ stream and output table #> Tue Dec 16 10:16:19 2025 => Streaming FASTQ input file /home/runner/work/_temp/Library/posDemux/extdata/PETRI-seq_forward_reads.fq.gz #> Tue Dec 16 10:16:19 2025 => Processed 10000 reads, successfully demultiplexed 9117 reads so far... #> Tue Dec 16 10:16:19 2025 => Processed 20000 reads, successfully demultiplexed 18259 reads so far... #> Tue Dec 16 10:16:19 2025 => Processed 30000 reads, successfully demultiplexed 27362 reads so far... #> Tue Dec 16 10:16:19 2025 => Processed 40000 reads, successfully demultiplexed 36487 reads so far... #> Tue Dec 16 10:16:19 2025 => Processed 50000 reads, successfully demultiplexed 45629 reads so far... #> Tue Dec 16 10:16:19 2025 => Processed 56895 reads, successfully demultiplexed 51906 reads so far... #> Tue Dec 16 10:16:19 2025 => Done demultiplexing"},{"path":"https://yaccos.github.io/posDemux/news/index.html","id":"posdemux-0998","dir":"Changelog","previous_headings":"","what":"posDemux 0.99.8","title":"posDemux 0.99.8","text":"Avoided reading empty chunk twice streaming","code":""},{"path":"https://yaccos.github.io/posDemux/news/index.html","id":"posdemux-0996","dir":"Changelog","previous_headings":"","what":"posDemux 0.99.6","title":"posDemux 0.99.6","text":"Changed data loader default callbacks, allowing multiple input FASTQ files Fixed bug empty stringsets handled correctly","code":""},{"path":"https://yaccos.github.io/posDemux/news/index.html","id":"posdemux-0994","dir":"Changelog","previous_headings":"","what":"posDemux 0.99.4","title":"posDemux 0.99.4","text":"First package version submitted Bioconductor","code":""},{"path":"https://yaccos.github.io/posDemux/news/index.html","id":"posdemux-0991","dir":"Changelog","previous_headings":"","what":"posDemux 0.99.1","title":"posDemux 0.99.1","text":"Created NEWS.md file, first public version package.","code":""}]
